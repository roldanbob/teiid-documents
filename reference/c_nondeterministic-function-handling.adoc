// Module included in the following assemblies:
// as_scalar-functions.adoc
[id="nondeterministic-function-handling"]
= Nondeterministic function handling

{{ book.productnameFull }} categorizes functions by varying degrees of determinism. 
When a function is evaluated and to what extent the result can be cached are based upon its determinism level.

Deterministic:: The function always returns the same result for the given inputs. 
Deterministic functions are evaluated by the engine as soon as all input values are known, which may occur as soon as the rewrite phase. 
Some functions, such as the lookup function, are not truly deterministic, but are treated as such for performance. 
All functions that are not categorized according to the remaining items in this list are considered deterministic.

User Deterministic:: The function returns the same result for the given inputs for the same user. 
This includes the `hasRole` and `user` functions. 
User deterministic functions are evaluated by the engine as soon as all input values are known, which may occur as soon as the rewrite phase. 
If a user deterministic function is evaluated during the creation of a prepared processing plan, 
then the resulting plan will be cached only for the user.

Session Deterministic:: The function returns the same result for the given inputs under the same user session. 
This category includes the `env` function. 
Session deterministic functions are evaluated by the engine as soon as all input values are known, which may occur as soon as the rewrite phase. 
If a session deterministic function is evaluated during the creation of a prepared processing plan, 
then the resulting plan will be cached only for the user’s session.

Command Deterministic:: The result of function evaluation is only deterministic within the scope of the user command. 
This category include the `curdate`, `curtime`, `now`, and `commandpayload` functions. 
Command deterministic functions are delayed in evaluation until processing to ensure that even prepared plans 
utilizing these functions will be executed with relevant values. 
Command deterministic function evaluation will occur prior to pushdown. 
However, multiple occurrences of the same command deterministic time function are not guaranteed to evaluate to the same value.

Nondeterministic:: The result of function evaluation is fully nondeterministic. 
This category includes the `rand` function and UDFs marked as `nondeterministic`. 
Nondeterministic functions are delayed in evaluation until processing with a preference for pushdown. 
If the function is not pushed down, then it may be evaluated for every row in it’s execution context 
(for example, if the function is used in the select clause).  

NOTE: Uncorrelated subqueries will be treated as deterministic regardless of the functions used within them. 
